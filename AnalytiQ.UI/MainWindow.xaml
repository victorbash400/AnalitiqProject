<Window x:Class="MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        Title="AnalytiQ - Feedback Analytics Platform" 
        Height="800" Width="1200"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        ResizeMode="CanResizeWithGrip"
        AllowsTransparency="True"
        Background="Transparent">

    <Window.Resources>
        <!-- Refined Color Palette - Adjusted for better contrast -->
        <Color x:Key="PrimaryBackColorValue">#141414</Color>
        <Color x:Key="SecondaryBackColorValue">#1C1C1C</Color>
        <Color x:Key="ContentBackColorValue">#292929</Color>
        <!-- Lightened for better contrast -->
        <Color x:Key="PrimaryTextColorValue">#FFFFFF</Color>
        <Color x:Key="SecondaryTextColorValue">#F0F0F0</Color>
        <Color x:Key="MutedTextColorValue">#AAAAAA</Color>
        <Color x:Key="AccentColorValue">#34C759</Color>
        <Color x:Key="SecondaryAccentColorValue">#4CD964</Color>
        <Color x:Key="CardBackgroundValue">#222222</Color>
        <!-- Lightened for better contrast -->
        <Color x:Key="BorderColorValue">#333333</Color>
        <!-- Lightened for better contrast -->
        <Color x:Key="NavHoverColorValue">#323232</Color>
        <!-- Lightened for better contrast -->
        <Color x:Key="NavActiveColorValue">#2D2D2D</Color>
        <!-- Lightened slightly -->
        <Color x:Key="SidebarBackColorValue">#080808</Color>
        <!-- Darkened for contrast against content -->
        <Color x:Key="HeaderBackColorValue">#0A0A0A</Color>
        <!-- Darkened slightly for contrast -->
        <Color x:Key="WarningColorValue">#FF3B30</Color>
        <Color x:Key="DarkShadowColorValue">#000000</Color>

        <SolidColorBrush x:Key="PrimaryBackColor" Color="{StaticResource PrimaryBackColorValue}"/>
        <SolidColorBrush x:Key="SecondaryBackColor" Color="{StaticResource SecondaryBackColorValue}"/>
        <SolidColorBrush x:Key="ContentBackColor" Color="{StaticResource ContentBackColorValue}"/>
        <SolidColorBrush x:Key="PrimaryTextColor" Color="{StaticResource PrimaryTextColorValue}"/>
        <SolidColorBrush x:Key="SecondaryTextColor" Color="{StaticResource SecondaryTextColorValue}"/>
        <SolidColorBrush x:Key="MutedTextColor" Color="{StaticResource MutedTextColorValue}"/>
        <SolidColorBrush x:Key="AccentColor" Color="{StaticResource AccentColorValue}"/>
        <SolidColorBrush x:Key="SecondaryAccentColor" Color="{StaticResource SecondaryAccentColorValue}"/>
        <SolidColorBrush x:Key="CardBackground" Color="{StaticResource CardBackgroundValue}"/>
        <SolidColorBrush x:Key="BorderColor" Color="{StaticResource BorderColorValue}"/>
        <SolidColorBrush x:Key="NavHoverColor" Color="{StaticResource NavHoverColorValue}"/>
        <SolidColorBrush x:Key="NavActiveColor" Color="{StaticResource NavActiveColorValue}"/>
        <SolidColorBrush x:Key="SidebarBackColor" Color="{StaticResource SidebarBackColorValue}"/>
        <SolidColorBrush x:Key="HeaderBackColor" Color="{StaticResource HeaderBackColorValue}"/>
        <SolidColorBrush x:Key="WarningColor" Color="{StaticResource WarningColorValue}"/>

        <!-- Refined Gradients - Adjusted for better contrast -->
        <LinearGradientBrush x:Key="AccentGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="{StaticResource AccentColorValue}" Offset="0.0"/>
            <GradientStop Color="{StaticResource SecondaryAccentColorValue}" Offset="1.0"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="SidebarGradient" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#070707" Offset="0.0"/>
            <GradientStop Color="#0F0F0F" Offset="1.0"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="ContentGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#242424" Offset="0.0"/>
            <!-- Lightened for better contrast -->
            <GradientStop Color="#282828" Offset="1.0"/>
            <!-- Lightened for better contrast -->
        </LinearGradientBrush>

        <!-- Shadows remain the same -->
        <DropShadowEffect x:Key="StandardShadow" ShadowDepth="3" Direction="315" Opacity="0.35" BlurRadius="12" Color="{StaticResource DarkShadowColorValue}"/>
        <DropShadowEffect x:Key="ContentShadow" ShadowDepth="2" Direction="315" Opacity="0.25" BlurRadius="10" Color="{StaticResource DarkShadowColorValue}"/>
        <DropShadowEffect x:Key="SidebarShadow" ShadowDepth="4" Direction="0" Opacity="0.3" BlurRadius="14" Color="{StaticResource DarkShadowColorValue}"/>
        <DropShadowEffect x:Key="AccentShadow" ShadowDepth="0" BlurRadius="10" Opacity="0.5" Color="{StaticResource AccentColorValue}"/>

        <!-- Updated Navigation Button Style - Refined spacing and highlight effects -->
        <Style x:Key="NavButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource MutedTextColor}"/>
            <Setter Property="Height" Value="44"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Margin" Value="6,2,6,2"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <Border x:Name="IndicatorBar" 
                                    Width="4" 
                                    HorizontalAlignment="Left" 
                                    Background="{StaticResource AccentGradient}" 
                                    CornerRadius="0,2,2,0" 
                                    Opacity="0">
                                <Border.Effect>
                                    <DropShadowEffect ShadowDepth="0" BlurRadius="8" Opacity="0.7" Color="{StaticResource AccentColorValue}"/>
                                </Border.Effect>
                            </Border>
                            <Border x:Name="MainBorder" 
                                    Background="{TemplateBinding Background}" 
                                    BorderThickness="0" 
                                    CornerRadius="8"
                                    Margin="4,0,4,0">
                                <ContentPresenter HorizontalAlignment="Left" VerticalAlignment="Center"/>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource NavHoverColor}" TargetName="MainBorder"/>
                                <Setter Property="Foreground" Value="{StaticResource SecondaryTextColor}"/>
                                <Setter Property="Opacity" Value="0.8" TargetName="IndicatorBar"/>
                                <Setter TargetName="MainBorder" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect ShadowDepth="0" BlurRadius="6" Opacity="0.15" Color="Black"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="{StaticResource NavHoverColor}" TargetName="MainBorder"/>
                                <Setter Property="Opacity" Value="1" TargetName="IndicatorBar"/>
                            </Trigger>
                            <Trigger Property="Tag" Value="Selected">
                                <Setter Property="Background" Value="{StaticResource NavActiveColor}" TargetName="MainBorder"/>
                                <Setter Property="Foreground" Value="{StaticResource AccentColor}"/>
                                <Setter Property="Opacity" Value="1" TargetName="IndicatorBar"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                                <Setter TargetName="MainBorder" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect ShadowDepth="0" BlurRadius="10" Opacity="0.2" Color="Black"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Other styles remain the same -->
        <Style x:Key="WindowControlButton" TargetType="Button">
            <Setter Property="Width" Value="30"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#B0B0B0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="15" 
                                Padding="5">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#2A2A2A"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="AvatarStyle" TargetType="Border">
            <Setter Property="Width" Value="36"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="CornerRadius" Value="18"/>
            <Setter Property="Background" Value="#2C2C2C"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect ShadowDepth="1" Direction="315" Opacity="0.3" BlurRadius="5"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="LogoStyle" TargetType="Border">
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Background" Value="{StaticResource AccentGradient}"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="22,0,0,0"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect ShadowDepth="0" Direction="0" Opacity="0.5" BlurRadius="10" Color="{StaticResource AccentColorValue}"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ModernProgressBarStyle" TargetType="ProgressBar">
            <Setter Property="Height" Value="4"/>
            <Setter Property="Foreground" Value="{StaticResource AccentColor}"/>
            <Setter Property="Background" Value="#333333"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ProgressBar">
                        <Grid x:Name="TemplateRoot" SnapsToDevicePixels="true">
                            <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" 
                                    BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="2"/>
                            <Border x:Name="PART_Indicator" HorizontalAlignment="Left" 
                                    Background="{TemplateBinding Foreground}" CornerRadius="2" Margin="0">
                                <Border.Effect>
                                    <DropShadowEffect ShadowDepth="0" BlurRadius="4" Color="{StaticResource AccentColorValue}" Opacity="0.5"/>
                                </Border.Effect>
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource CardBackground}"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="24"/>
            <Setter Property="Margin" Value="12"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="Black" BlurRadius="12" ShadowDepth="2" Opacity="0.25"/>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <!-- Main Window Border with Enhanced Drop Shadow -->
    <Border CornerRadius="16" Background="{StaticResource PrimaryBackColor}" Margin="10">
        <Border.Effect>
            <DropShadowEffect BlurRadius="20" Direction="315" Opacity="0.4" ShadowDepth="8" Color="#000000"/>
        </Border.Effect>

        <!-- Main Layout -->
        <Grid Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="260"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="70"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Custom Window Title Bar -->
            <Grid Grid.ColumnSpan="2" Grid.Row="0" 
                  Background="{StaticResource PrimaryBackColor}"
                  MouseLeftButtonDown="WindowMouseDown">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Logo and App Name -->
                <StackPanel Grid.Column="0" 
                            Orientation="Horizontal" 
                            VerticalAlignment="Center">
                    <Border Style="{StaticResource LogoStyle}">
                        <TextBlock Text="A" 
                                   Foreground="White" 
                                   FontWeight="Bold" 
                                   FontSize="20"
                                   VerticalAlignment="Center" 
                                   HorizontalAlignment="Center"/>
                    </Border>
                    <TextBlock Text="AnalytiQ" 
                               Foreground="{StaticResource PrimaryTextColor}" 
                               FontWeight="Bold" 
                               FontSize="18" 
                               FontFamily="Segoe UI" 
                               VerticalAlignment="Center"
                               Margin="14,0,0,0"/>
                </StackPanel>

                <!-- App Title - Centered -->
                <TextBlock Grid.Column="1" 
                           Text="Feedback Analytics Platform" 
                           Foreground="{StaticResource MutedTextColor}" 
                           FontSize="15" 
                           FontWeight="Medium"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"/>

                <!-- User Profile and Window Controls -->
                <StackPanel Grid.Column="2" 
                            Orientation="Horizontal" 
                            VerticalAlignment="Center" 
                            Margin="0,0,20,0">
                    <!-- Bell Notification -->
                    <Button Style="{StaticResource WindowControlButton}" 
                            Margin="0,0,16,0"
                            ToolTip="Notifications">
                        <Grid>
                            <TextBlock Text="🔔" FontSize="14" Foreground="White"/>
                            <Border Background="{StaticResource WarningColor}" Width="8" Height="8" CornerRadius="4" 
                                    HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,-2,-2,0"/>
                        </Grid>
                    </Button>

                    <!-- Avatar -->
                    <Border Style="{StaticResource AvatarStyle}" Margin="0,0,20,0">
                        <TextBlock Text="ML" 
                                   Foreground="White" 
                                   FontWeight="Medium" 
                                   FontSize="13"
                                   VerticalAlignment="Center" 
                                   HorizontalAlignment="Center"/>
                    </Border>

                    <!-- Window Controls -->
                    <Button x:Name="btnMinimize" 
                            Style="{StaticResource WindowControlButton}" 
                            Click="BtnMinimize_Click" 
                            ToolTip="Minimize"
                            Margin="5,0">
                        <TextBlock Text="🗕" FontSize="12"/>
                    </Button>
                    <Button x:Name="btnMaximize" 
                            Style="{StaticResource WindowControlButton}" 
                            Click="BtnMaximize_Click" 
                            ToolTip="Maximize"
                            Margin="5,0">
                        <TextBlock x:Name="MaximizeIcon" Text="🗖" FontSize="12"/>
                    </Button>
                    <Button x:Name="btnClose" 
                            Style="{StaticResource WindowControlButton}" 
                            Click="BtnClose_Click" 
                            ToolTip="Close"
                            Margin="5,0">
                        <TextBlock Text="✕" FontSize="12" Foreground="{StaticResource WarningColor}"/>
                    </Button>
                </StackPanel>
            </Grid>

            <!-- Modernized Sidebar Navigation with enhanced styling and animations -->
            <Border Grid.Column="0" 
        Grid.Row="1" 
        CornerRadius="16"
        Margin="16,16,8,16">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#1E1E2E" Offset="0.0"/>
                        <GradientStop Color="#181825" Offset="1.0"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Border.Effect>
                    <DropShadowEffect ShadowDepth="2" BlurRadius="10" Opacity="0.3" Color="#000000"/>
                </Border.Effect>

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Navigation Menu - Enhanced with animations and modern styling -->
                    <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto" Margin="0,24,0,0">
                        <StackPanel>
                            <TextBlock Text="MAIN MENU" 
                           Margin="28,4,0,18" 
                           FontSize="12" 
                           FontWeight="DemiBold"
                           FontFamily="Segoe UI"
                           Foreground="#94A3B8"/>

                            <!-- Navigation Buttons with modernized styling -->
                            <ItemsControl x:Name="NavigationItems">
                                <ItemsControl.Resources>
                                    <!-- Modern Navigation Button Style -->
                                    <Style x:Key="ModernNavButton" TargetType="Button">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Foreground" Value="#E2E8F0"/>
                                        <Setter Property="Padding" Value="20,12"/>
                                        <Setter Property="Margin" Value="8,2,8,2"/>
                                        <Setter Property="BorderThickness" Value="0"/>
                                        <Setter Property="Cursor" Value="Hand"/>
                                        <Setter Property="FontSize" Value="14"/>
                                        <Setter Property="FontWeight" Value="Medium"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border x:Name="NavBorder" 
                                                CornerRadius="12" 
                                                Background="{TemplateBinding Background}" 
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter />
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="NavBorder" Property="Background" Value="#313244"/>
                                                            <Setter Property="Foreground" Value="#FFFFFF"/>
                                                        </Trigger>
                                                        <DataTrigger Binding="{Binding Tag}" Value="Selected">
                                                            <Setter TargetName="NavBorder" Property="Background">
                                                                <Setter.Value>
                                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                        <GradientStop Color="#7C3AED" Offset="0.0"/>
                                                                        <GradientStop Color="#8B5CF6" Offset="1.0"/>
                                                                    </LinearGradientBrush>
                                                                </Setter.Value>
                                                            </Setter>
                                                            <Setter Property="Foreground" Value="#FFFFFF"/>
                                                        </DataTrigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ItemsControl.Resources>

                                <Button x:Name="btnDashboard" Content="Dashboard" Tag="Selected" Style="{StaticResource ModernNavButton}" Click="Navigation_Click">
                                    <Button.ContentTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <Border Width="36" Height="36" Grid.Column="0" CornerRadius="10" Margin="0,0,14,0">
                                                    <Border.Background>
                                                        <SolidColorBrush Color="#2D2D3F" Opacity="0.7"/>
                                                    </Border.Background>
                                                    <Path Data="M3,13H11V3H3V13M3,21H11V15H3V21M13,21H21V11H13V21M13,3V9H21V3H13Z" 
                                              Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}" 
                                              Width="18" Height="18" 
                                              Stretch="Uniform"/>
                                                </Border>

                                                <TextBlock Grid.Column="1" 
                                               Text="{Binding}" 
                                               VerticalAlignment="Center"
                                               FontFamily="Segoe UI"
                                               Foreground="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Button.ContentTemplate>
                                </Button>

                                <Button x:Name="btnAnalytics" Content="Analytics" Style="{StaticResource ModernNavButton}" Click="Navigation_Click">
                                    <Button.ContentTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <Border Width="36" Height="36" Grid.Column="0" CornerRadius="10" Margin="0,0,14,0">
                                                    <Border.Background>
                                                        <SolidColorBrush Color="#2D2D3F" Opacity="0.7"/>
                                                    </Border.Background>
                                                    <Path Data="M21,8L21,6L18.5,6L18.5,2L16.5,2L16.5,6L14,6L14,8L16.5,8L16.5,12L18.5,12L18.5,8L21,8ZM10,2L10,18L21,19L21,21L10,21.5L2,21.5L2,19.5L4,19L4,2.5L6,2L10,2Z" 
                                              Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}" 
                                              Width="18" Height="18" 
                                              Stretch="Uniform"/>
                                                </Border>

                                                <TextBlock Grid.Column="1" 
                                               Text="{Binding}" 
                                               VerticalAlignment="Center"
                                               FontFamily="Segoe UI"
                                               Foreground="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Button.ContentTemplate>
                                </Button>

                                <Button x:Name="btnDataUpload" Content="Data Upload" Style="{StaticResource ModernNavButton}" Click="Navigation_Click">
                                    <Button.ContentTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <Border Width="36" Height="36" Grid.Column="0" CornerRadius="10" Margin="0,0,14,0">
                                                    <Border.Background>
                                                        <SolidColorBrush Color="#2D2D3F" Opacity="0.7"/>
                                                    </Border.Background>
                                                    <Path Data="M14,13V17H10V13H7L12,8L17,13H14M19.35,10.03C18.67,6.59 15.64,4 12,4C9.11,4 6.6,5.64 5.35,8.03C2.34,8.36 0,10.9 0,14A6,6 0 0,0 6,20H19A5,5 0 0,0 24,15C24,12.36 21.95,10.22 19.35,10.03Z" 
                                              Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}" 
                                              Width="18" Height="18" 
                                              Stretch="Uniform"/>
                                                </Border>

                                                <TextBlock Grid.Column="1" 
                                               Text="{Binding}" 
                                               VerticalAlignment="Center"
                                               FontFamily="Segoe UI"
                                               Foreground="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Button.ContentTemplate>
                                </Button>

                                <TextBlock Text="CONFIGURATION" 
                               Margin="28,32,0,18" 
                               FontSize="12" 
                               FontWeight="DemiBold"
                               FontFamily="Segoe UI"
                               Foreground="#94A3B8"/>

                                <Button x:Name="btnSettings" Content="Settings" Style="{StaticResource ModernNavButton}" Click="Navigation_Click">
                                    <Button.ContentTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <Border Width="36" Height="36" Grid.Column="0" CornerRadius="10" Margin="0,0,14,0">
                                                    <Border.Background>
                                                        <SolidColorBrush Color="#2D2D3F" Opacity="0.7"/>
                                                    </Border.Background>
                                                    <Path Data="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" 
                                              Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}" 
                                              Width="18" Height="18" 
                                              Stretch="Uniform"/>
                                                </Border>

                                                <TextBlock Grid.Column="1" 
                                               Text="{Binding}" 
                                               VerticalAlignment="Center"
                                               FontFamily="Segoe UI"
                                               Foreground="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Button.ContentTemplate>
                                </Button>

                                <Button x:Name="btnAdmin" Content="Admin" Style="{StaticResource ModernNavButton}" Click="Navigation_Click">
                                    <Button.ContentTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <Border Width="36" Height="36" Grid.Column="0" CornerRadius="10" Margin="0,0,14,0">
                                                    <Border.Background>
                                                        <SolidColorBrush Color="#2D2D3F" Opacity="0.7"/>
                                                    </Border.Background>
                                                    <Path Data="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,5A3,3 0 0,1 15,8A3,3 0 0,1 12,11A3,3 0 0,1 9,8A3,3 0 0,1 12,5M17.13,17C15.92,18.85 14.11,20.24 12,20.92C9.89,20.24 8.08,18.85 6.87,17C6.53,16.5 6.24,16 6,15.47C6,13.82 8.71,12.47 12,12.47C15.29,12.47 18,13.79 18,15.47C17.76,16 17.47,16.5 17.13,17Z" 
                                              Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}" 
                                              Width="18" Height="18" 
                                              Stretch="Uniform"/>
                                                </Border>

                                                <TextBlock Grid.Column="1" 
                                               Text="{Binding}" 
                                               VerticalAlignment="Center"
                                               FontFamily="Segoe UI"
                                               Foreground="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}"/>
                                            </Grid>
                                        </DataTemplate>
                                    </Button.ContentTemplate>
                                </Button>
                            </ItemsControl>
                        </StackPanel>
                    </ScrollViewer>

                    <!-- Version info with modern styling -->
                    <Border Grid.Row="1" 
                Margin="16,0,16,12" 
                Padding="12,8" 
                CornerRadius="8"
                Background="#2D2D3F"
                Opacity="0.7">
                        <StackPanel Orientation="Horizontal">
                            <Ellipse Width="6" Height="6" Fill="#4ADE80" Margin="0,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Version 1.0.5" 
                           Foreground="#94A3B8" 
                           FontSize="11"
                           FontWeight="Medium"
                           VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>

            <Grid Grid.Column="1" Grid.Row="1" Margin="12,16,20,16">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Modernized Header -->
                <Border Grid.Row="0" 
            CornerRadius="16"
            Padding="0,0,0,0"
            Margin="0,0,0,16">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                            <GradientStop Color="#1E1E2E" Offset="0.0"/>
                            <GradientStop Color="#232338" Offset="1.0"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="1" BlurRadius="8" Opacity="0.2" Color="#000000"/>
                    </Border.Effect>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Page Title with accent border -->
                        <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="28,22,0,22">
                            <Border Width="4" Height="26" CornerRadius="2" Margin="0,0,16,0">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="#7C3AED" Offset="0.0"/>
                                        <GradientStop Color="#8B5CF6" Offset="1.0"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>

                            <TextBlock x:Name="PageTitle" 
                           Text="Dashboard" 
                           FontSize="24" 
                           FontWeight="SemiBold" 
                           Foreground="White" 
                           VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- Quick Actions -->
                        <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="0,0,28,0">
                            <Button Width="42" Height="42" Margin="8,0,0,0" Background="Transparent" BorderThickness="0">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="ActionBorder" 
                                    Width="42" Height="42" 
                                    CornerRadius="12" 
                                    Background="#2D2D3F">
                                            <Path Data="M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22C17.53,22 22,17.53 22,12C22,6.47 17.53,2 12,2M15.1,7.07C15.24,7.07 15.38,7.12 15.5,7.23L16.77,8.5C17,8.72 17,9.07 16.77,9.28L15.77,10.28L13.72,8.23L14.72,7.23C14.82,7.12 14.96,7.07 15.1,7.07M13.13,8.81L15.19,10.87L9.13,16.93H7.07V14.87L13.13,8.81Z" 
                                      Fill="#94A3B8" 
                                      Width="18" 
                                      Height="18" 
                                      Stretch="Uniform"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="ActionBorder" Property="Background" Value="#313244"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>

                            <Button Width="42" Height="42" Margin="8,0,0,0" Background="Transparent" BorderThickness="0">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="ActionBorder" 
                                    Width="42" Height="42" 
                                    CornerRadius="12" 
                                    Background="#2D2D3F">
                                            <Path Data="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" 
                                      Fill="#94A3B8" 
                                      Width="18" 
                                      Height="18" 
                                      Stretch="Uniform"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="ActionBorder" Property="Background" Value="#313244"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>

                            <Button Width="42" Height="42" Margin="8,0,0,0" Background="Transparent" BorderThickness="0">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="ActionBorder" 
                                    Width="42" Height="42" 
                                    CornerRadius="12" 
                                    Background="#2D2D3F">
                                            <Path Data="M12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22M13,17H11V15H13V17M13,13H11V7H13V13Z" 
                                      Fill="#94A3B8" 
                                      Width="18" 
                                      Height="18" 
                                      Stretch="Uniform"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="ActionBorder" Property="Background" Value="#313244"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Main Content - Lightened for better contrast against darker elements -->
                <Border Grid.Row="1" 
        Margin="0,16,0,0" 
        CornerRadius="16">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                            <GradientStop Color="#1A1B26" Offset="0.0"/>
                            <GradientStop Color="#1E1E2E" Offset="1.0"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="1" BlurRadius="10" Opacity="0.2" Color="#000000"/>
                    </Border.Effect>

                    <Grid>
                        <!-- Main content containers with improved styling -->
                        <Frame x:Name="MainFrame" 
               NavigationUIVisibility="Hidden" 
               Background="Transparent" 
               Margin="0" 
               Visibility="Collapsed"/>

                        <Border Margin="0" CornerRadius="16" ClipToBounds="True">
                            <wv2:WebView2 x:Name="PowerBIWebView" 
                          Visibility="Collapsed" 
                          Margin="0"/>
                        </Border>

                        <wv2:WebView2 x:Name="PowerBIWebViewPreload" 
                      Visibility="Collapsed" 
                      Margin="0"/>

                        <!-- Modern Loading Indicator -->
                        <Grid x:Name="LoadingContainer" Visibility="Visible">
                            <Border Background="#1A1A2A" 
                    Opacity="0.7" 
                    CornerRadius="16"/>

                            <StackPanel VerticalAlignment="Center" 
                        HorizontalAlignment="Center">
                                <!-- Pulsing loading circle -->
                                <Border Width="80" 
                        Height="80" 
                        CornerRadius="40" 
                        HorizontalAlignment="Center" 
                        Margin="0,0,0,20">
                                    <Border.Background>
                                        <SolidColorBrush Color="#232338" Opacity="0.8"/>
                                    </Border.Background>

                                    <Border Width="60" 
                            Height="60" 
                            CornerRadius="30">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                <GradientStop Color="#7C3AED" Offset="0.0"/>
                                                <GradientStop Color="#8B5CF6" Offset="1.0"/>
                                            </LinearGradientBrush>
                                        </Border.Background>

                                        <Border.Triggers>
                                            <EventTrigger RoutedEvent="Border.Loaded">
                                                <BeginStoryboard>
                                                    <Storyboard>
                                                        <DoubleAnimation 
                                            Storyboard.TargetProperty="Opacity"
                                            From="1.0" To="0.4" Duration="0:0:1"
                                            AutoReverse="True" RepeatBehavior="Forever"/>
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </EventTrigger>
                                        </Border.Triggers>

                                        <Path Data="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12H20A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4V2Z" 
                              Fill="White" 
                              Width="30" 
                              Height="30" 
                              Stretch="Uniform">
                                            <Path.RenderTransform>
                                                <RotateTransform x:Name="SpinningTransform" CenterX="15" CenterY="15"/>
                                            </Path.RenderTransform>
                                            <Path.Triggers>
                                                <EventTrigger RoutedEvent="Path.Loaded">
                                                    <BeginStoryboard>
                                                        <Storyboard>
                                                            <DoubleAnimation 
                                                Storyboard.TargetName="SpinningTransform"
                                                Storyboard.TargetProperty="Angle"
                                                From="0" To="360" Duration="0:0:1.5"
                                                RepeatBehavior="Forever"/>
                                                        </Storyboard>
                                                    </BeginStoryboard>
                                                </EventTrigger>
                                            </Path.Triggers>
                                        </Path>
                                    </Border>
                                </Border>

                                <!-- Loading text -->
                                <TextBlock Text="Loading Dashboard" 
                           FontSize="16" 
                           Foreground="White" 
                           FontWeight="Medium" 
                           HorizontalAlignment="Center"/>

                                <TextBlock Text="Please wait while we prepare your data" 
                           FontSize="14" 
                           Foreground="#94A3B8" 
                           Margin="0,8,0,0" 
                           HorizontalAlignment="Center"/>

                                <!-- Progress bar replacement -->
                                <Border Width="240" 
                        Height="4" 
                        Background="#2D2D3F" 
                        CornerRadius="2" 
                        Margin="0,24,0,0">
                                    <Border x:Name="ProgressIndicator" 
                            Width="80" 
                            Height="4" 
                            Background="#7C3AED" 
                            CornerRadius="2" 
                            HorizontalAlignment="Left">
                                        <Border.Triggers>
                                            <EventTrigger RoutedEvent="Border.Loaded">
                                                <BeginStoryboard>
                                                    <Storyboard>
                                                        <ThicknessAnimation 
                                            Storyboard.TargetProperty="Margin"
                                            From="0,0,0,0" To="160,0,0,0" Duration="0:0:1.5"
                                            AutoReverse="True" RepeatBehavior="Forever"/>
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </EventTrigger>
                                        </Border.Triggers>
                                    </Border>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Window>