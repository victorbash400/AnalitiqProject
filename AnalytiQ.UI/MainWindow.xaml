<Window x:Class="MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        Title="AnalytiQ - Feedback Analytics Platform" 
        Height="800" Width="1200"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        ResizeMode="CanResizeWithGrip"
        AllowsTransparency="True"
        Background="Transparent">

    <Window.Resources>
        <!-- Refined Color Palette - Adjusted darker colors for better contrast -->
        <Color x:Key="PrimaryBackColorValue">#121212</Color>
        <Color x:Key="SecondaryBackColorValue">#1A1A1A</Color>
        <Color x:Key="ContentBackColorValue">#242424</Color>
        <Color x:Key="PrimaryTextColorValue">#FFFFFF</Color>
        <Color x:Key="SecondaryTextColorValue">#F0F0F0</Color>
        <Color x:Key="MutedTextColorValue">#AAAAAA</Color>
        <Color x:Key="AccentColorValue">#34C759</Color>
        <Color x:Key="SecondaryAccentColorValue">#4CD964</Color>
        <Color x:Key="CardBackgroundValue">#1E1E1E</Color>
        <Color x:Key="BorderColorValue">#2C2C2E</Color>
        <Color x:Key="NavHoverColorValue">#303030</Color>
        <Color x:Key="NavActiveColorValue">#2A2A2A</Color>
        <Color x:Key="SidebarBackColorValue">#0D0D0D</Color>
        <Color x:Key="HeaderBackColorValue">#0D0D0D</Color>
        <Color x:Key="WarningColorValue">#FF3B30</Color>
        <Color x:Key="DarkShadowColorValue">#000000</Color>

        <SolidColorBrush x:Key="PrimaryBackColor" Color="{StaticResource PrimaryBackColorValue}"/>
        <SolidColorBrush x:Key="SecondaryBackColor" Color="{StaticResource SecondaryBackColorValue}"/>
        <SolidColorBrush x:Key="ContentBackColor" Color="{StaticResource ContentBackColorValue}"/>
        <SolidColorBrush x:Key="PrimaryTextColor" Color="{StaticResource PrimaryTextColorValue}"/>
        <SolidColorBrush x:Key="SecondaryTextColor" Color="{StaticResource SecondaryTextColorValue}"/>
        <SolidColorBrush x:Key="MutedTextColor" Color="{StaticResource MutedTextColorValue}"/>
        <SolidColorBrush x:Key="AccentColor" Color="{StaticResource AccentColorValue}"/>
        <SolidColorBrush x:Key="SecondaryAccentColor" Color="{StaticResource SecondaryAccentColorValue}"/>
        <SolidColorBrush x:Key="CardBackground" Color="{StaticResource CardBackgroundValue}"/>
        <SolidColorBrush x:Key="BorderColor" Color="{StaticResource BorderColorValue}"/>
        <SolidColorBrush x:Key="NavHoverColor" Color="{StaticResource NavHoverColorValue}"/>
        <SolidColorBrush x:Key="NavActiveColor" Color="{StaticResource NavActiveColorValue}"/>
        <SolidColorBrush x:Key="SidebarBackColor" Color="{StaticResource SidebarBackColorValue}"/>
        <SolidColorBrush x:Key="HeaderBackColor" Color="{StaticResource HeaderBackColorValue}"/>
        <SolidColorBrush x:Key="WarningColor" Color="{StaticResource WarningColorValue}"/>

        <!-- Refined Gradients -->
        <LinearGradientBrush x:Key="AccentGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="{StaticResource AccentColorValue}" Offset="0.0"/>
            <GradientStop Color="{StaticResource SecondaryAccentColorValue}" Offset="1.0"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="SidebarGradient" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#0A0A0A" Offset="0.0"/>
            <GradientStop Color="#121212" Offset="1.0"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="ContentGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#1E1E1E" Offset="0.0"/>
            <GradientStop Color="#222222" Offset="1.0"/>
        </LinearGradientBrush>

        <!-- Improved Drop Shadows -->
        <DropShadowEffect x:Key="StandardShadow" ShadowDepth="3" Direction="315" Opacity="0.35" BlurRadius="12" Color="{StaticResource DarkShadowColorValue}"/>
        <DropShadowEffect x:Key="ContentShadow" ShadowDepth="2" Direction="315" Opacity="0.25" BlurRadius="10" Color="{StaticResource DarkShadowColorValue}"/>
        <DropShadowEffect x:Key="SidebarShadow" ShadowDepth="4" Direction="0" Opacity="0.3" BlurRadius="14" Color="{StaticResource DarkShadowColorValue}"/>
        <DropShadowEffect x:Key="AccentShadow" ShadowDepth="0" BlurRadius="10" Opacity="0.5" Color="{StaticResource AccentColorValue}"/>

        <!-- Updated Navigation Button Style with more rectangular shape -->
        <Style x:Key="NavButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource MutedTextColor}"/>
            <Setter Property="Height" Value="46"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Margin" Value="6,3,6,3"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <Border x:Name="IndicatorBar" 
                                    Width="4" 
                                    HorizontalAlignment="Left" 
                                    Background="{StaticResource AccentGradient}" 
                                    CornerRadius="0,2,2,0" 
                                    Opacity="0">
                                <Border.Effect>
                                    <DropShadowEffect ShadowDepth="0" BlurRadius="6" Opacity="0.6" Color="{StaticResource AccentColorValue}"/>
                                </Border.Effect>
                            </Border>
                            <Border x:Name="MainBorder" 
                                    Background="{TemplateBinding Background}" 
                                    BorderThickness="0" 
                                    CornerRadius="6"
                                    Margin="5,0,5,0">
                                <ContentPresenter HorizontalAlignment="Left" VerticalAlignment="Center"/>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource NavHoverColor}" TargetName="MainBorder"/>
                                <Setter Property="Foreground" Value="{StaticResource SecondaryTextColor}"/>
                                <Setter Property="Opacity" Value="0.7" TargetName="IndicatorBar"/>
                                <Setter TargetName="MainBorder" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect ShadowDepth="0" BlurRadius="5" Opacity="0.1" Color="Black"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="{StaticResource NavHoverColor}" TargetName="MainBorder"/>
                                <Setter Property="Opacity" Value="1" TargetName="IndicatorBar"/>
                            </Trigger>
                            <Trigger Property="Tag" Value="Selected">
                                <Setter Property="Background" Value="{StaticResource NavActiveColor}" TargetName="MainBorder"/>
                                <Setter Property="Foreground" Value="{StaticResource AccentColor}"/>
                                <Setter Property="Opacity" Value="1" TargetName="IndicatorBar"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                                <Setter TargetName="MainBorder" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect ShadowDepth="0" BlurRadius="8" Opacity="0.15" Color="Black"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Window Control Button Style -->
        <Style x:Key="WindowControlButton" TargetType="Button">
            <Setter Property="Width" Value="30"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#B0B0B0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="15" 
                                Padding="5">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#2A2A2A"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Avatar Style -->
        <Style x:Key="AvatarStyle" TargetType="Border">
            <Setter Property="Width" Value="36"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="CornerRadius" Value="18"/>
            <Setter Property="Background" Value="#2C2C2C"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect ShadowDepth="1" Direction="315" Opacity="0.3" BlurRadius="5"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Logo Style -->
        <Style x:Key="LogoStyle" TargetType="Border">
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Background" Value="{StaticResource AccentGradient}"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="22,0,0,0"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect ShadowDepth="0" Direction="0" Opacity="0.5" BlurRadius="10" Color="{StaticResource AccentColorValue}"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Improved Progress Bar Style -->
        <Style x:Key="ModernProgressBarStyle" TargetType="ProgressBar">
            <Setter Property="Height" Value="4"/>
            <Setter Property="Foreground" Value="{StaticResource AccentColor}"/>
            <Setter Property="Background" Value="#333333"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ProgressBar">
                        <Grid x:Name="TemplateRoot" SnapsToDevicePixels="true">
                            <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" 
                                    BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="2"/>
                            <Border x:Name="PART_Indicator" HorizontalAlignment="Left" 
                                    Background="{TemplateBinding Foreground}" CornerRadius="2" Margin="0">
                                <Border.Effect>
                                    <DropShadowEffect ShadowDepth="0" BlurRadius="4" Color="{StaticResource AccentColorValue}" Opacity="0.5"/>
                                </Border.Effect>
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Card Style -->
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource CardBackground}"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="24"/>
            <Setter Property="Margin" Value="12"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="Black" BlurRadius="12" ShadowDepth="2" Opacity="0.25"/>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <!-- Main Window Border with Enhanced Drop Shadow -->
    <Border CornerRadius="16" Background="{StaticResource PrimaryBackColor}" Margin="10">
        <Border.Effect>
            <DropShadowEffect BlurRadius="20" Direction="315" Opacity="0.4" ShadowDepth="8" Color="#000000"/>
        </Border.Effect>

        <!-- Main Layout -->
        <Grid Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="260"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="70"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Custom Window Title Bar -->
            <Grid Grid.ColumnSpan="2" Grid.Row="0" 
                  Background="{StaticResource PrimaryBackColor}"
                  MouseLeftButtonDown="WindowMouseDown">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Logo and App Name -->
                <StackPanel Grid.Column="0" 
                            Orientation="Horizontal" 
                            VerticalAlignment="Center">
                    <Border Style="{StaticResource LogoStyle}">
                        <TextBlock Text="A" 
                                   Foreground="White" 
                                   FontWeight="Bold" 
                                   FontSize="20"
                                   VerticalAlignment="Center" 
                                   HorizontalAlignment="Center"/>
                    </Border>
                    <TextBlock Text="AnalytiQ" 
                               Foreground="{StaticResource PrimaryTextColor}" 
                               FontWeight="Bold" 
                               FontSize="18" 
                               FontFamily="Segoe UI" 
                               VerticalAlignment="Center"
                               Margin="14,0,0,0"/>
                </StackPanel>

                <!-- App Title - Centered -->
                <TextBlock Grid.Column="1" 
                           Text="Feedback Analytics Platform" 
                           Foreground="{StaticResource MutedTextColor}" 
                           FontSize="15" 
                           FontWeight="Medium"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"/>

                <!-- User Profile and Window Controls -->
                <StackPanel Grid.Column="2" 
                            Orientation="Horizontal" 
                            VerticalAlignment="Center" 
                            Margin="0,0,20,0">
                    <!-- Bell Notification -->
                    <Button Style="{StaticResource WindowControlButton}" 
                            Margin="0,0,16,0"
                            ToolTip="Notifications">
                        <Grid>
                            <TextBlock Text="🔔" FontSize="14" Foreground="White"/>
                            <Border Background="{StaticResource WarningColor}" Width="8" Height="8" CornerRadius="4" 
                                    HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,-2,-2,0"/>
                        </Grid>
                    </Button>

                    <!-- Avatar -->
                    <Border Style="{StaticResource AvatarStyle}" Margin="0,0,20,0">
                        <TextBlock Text="ML" 
                                   Foreground="White" 
                                   FontWeight="Medium" 
                                   FontSize="13"
                                   VerticalAlignment="Center" 
                                   HorizontalAlignment="Center"/>
                    </Border>

                    <!-- Window Controls -->
                    <Button x:Name="btnMinimize" 
                            Style="{StaticResource WindowControlButton}" 
                            Click="BtnMinimize_Click" 
                            ToolTip="Minimize"
                            Margin="5,0">
                        <TextBlock Text="🗕" FontSize="12"/>
                    </Button>
                    <Button x:Name="btnMaximize" 
                            Style="{StaticResource WindowControlButton}" 
                            Click="BtnMaximize_Click" 
                            ToolTip="Maximize"
                            Margin="5,0">
                        <TextBlock x:Name="MaximizeIcon" Text="🗖" FontSize="12"/>
                    </Button>
                    <Button x:Name="btnClose" 
                            Style="{StaticResource WindowControlButton}" 
                            Click="BtnClose_Click" 
                            ToolTip="Close"
                            Margin="5,0">
                        <TextBlock Text="✕" FontSize="12" Foreground="{StaticResource WarningColor}"/>
                    </Button>
                </StackPanel>
            </Grid>

            <!-- Sidebar Navigation with enhanced rounded corners and shadow -->
            <Border Grid.Column="0" 
                    Grid.Row="1" 
                    Background="{StaticResource SidebarGradient}"
                    CornerRadius="14"
                    Margin="14,14,6,16"
                    Effect="{StaticResource SidebarShadow}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Navigation Menu -->
                    <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto" Margin="0,24,0,0">
                        <StackPanel>
                            <TextBlock Text="MAIN MENU" 
                                       Margin="28,8,0,20" 
                                       Foreground="{StaticResource MutedTextColor}" 
                                       FontSize="11" 
                                       FontWeight="SemiBold" 
                                       Opacity="0.85"/>

                            <Button x:Name="btnDashboard" Content="Dashboard" Tag="Selected" Style="{StaticResource NavButtonStyle}" Click="Navigation_Click">
                                <Button.ContentTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Border Width="32" Height="32" Background="#2E2E2E" CornerRadius="8" Margin="0,0,14,0">
                                                <TextBlock Text="📊" FontSize="16" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                            <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </Button.ContentTemplate>
                            </Button>

                            <Button x:Name="btnAnalytics" Content="Analytics" Style="{StaticResource NavButtonStyle}" Click="Navigation_Click">
                                <Button.ContentTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Border Width="32" Height="32" Background="#2E2E2E" CornerRadius="8" Margin="0,0,14,0">
                                                <TextBlock Text="📈" FontSize="16" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                            <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </Button.ContentTemplate>
                            </Button>

                            <Button x:Name="btnDataUpload" Content="Data Upload" Style="{StaticResource NavButtonStyle}" Click="Navigation_Click">
                                <Button.ContentTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Border Width="32" Height="32" Background="#2E2E2E" CornerRadius="8" Margin="0,0,14,0">
                                                <TextBlock Text="📤" FontSize="16" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                            <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </Button.ContentTemplate>
                            </Button>

                            <TextBlock Text="CONFIGURATION" 
                                       Margin="28,30,0,20" 
                                       Foreground="{StaticResource MutedTextColor}" 
                                       FontSize="11" 
                                       FontWeight="SemiBold" 
                                       Opacity="0.85"/>

                            <Button x:Name="btnSettings" Content="Settings" Style="{StaticResource NavButtonStyle}" Click="Navigation_Click">
                                <Button.ContentTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Border Width="32" Height="32" Background="#2E2E2E" CornerRadius="8" Margin="0,0,14,0">
                                                <TextBlock Text="⚙️" FontSize="16" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                            <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </Button.ContentTemplate>
                            </Button>

                            <Button x:Name="btnAdmin" Content="Admin" Style="{StaticResource NavButtonStyle}" Click="Navigation_Click">
                                <Button.ContentTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Border Width="32" Height="32" Background="#2E2E2E" CornerRadius="8" Margin="0,0,14,0">
                                                <TextBlock Text="🔑" FontSize="16" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                            <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </Button.ContentTemplate>
                            </Button>
                        </StackPanel>
                    </ScrollViewer>

                    <!-- Version info -->
                    <TextBlock Grid.Row="1" 
                               Text="Version 1.0.5" 
                               Foreground="{StaticResource MutedTextColor}" 
                               FontSize="11"
                               Margin="28,0,0,20"
                               VerticalAlignment="Bottom"/>
                </Grid>
            </Border>

            <!-- Main Content Area -->
            <Grid Grid.Column="1" Grid.Row="1" Margin="12,14,20,16">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Header - Reduced corner radius -->
                <Border Grid.Row="0" 
                        Background="{StaticResource HeaderBackColor}" 
                        BorderThickness="0" 
                        Padding="28,20,28,20"
                        CornerRadius="12">
                    <Grid>
                        <!-- Page Title -->
                        <TextBlock x:Name="PageTitle" 
                                   Text="Dashboard" 
                                   FontSize="22" 
                                   FontWeight="SemiBold" 
                                   Foreground="White" 
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Left"/>
                    </Grid>
                </Border>

                <!-- Main Content with soft shadow and refined curves -->
                <Border Grid.Row="1" 
                        Background="{StaticResource ContentGradient}" 
                        Margin="0,16,0,0" 
                        CornerRadius="14"
                        Effect="{StaticResource ContentShadow}">
                    <Grid>
                        <Frame x:Name="MainFrame" NavigationUIVisibility="Hidden" Background="Transparent" Margin="0" Visibility="Collapsed"/>
                        <Border Margin="0">
                            <wv2:WebView2 x:Name="PowerBIWebView" Visibility="Collapsed" Margin="0"/>
                        </Border>
                        <wv2:WebView2 x:Name="PowerBIWebViewPreload" Visibility="Collapsed" Margin="0"/>
                        <ProgressBar x:Name="LoadingProgress" Style="{StaticResource ModernProgressBarStyle}" 
                                     IsIndeterminate="True" Visibility="Visible" VerticalAlignment="Top"/>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Window>